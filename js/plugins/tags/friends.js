"use strict";var FriendsJS={requestAPI:function(e,t,r){var n=5;!function a(){return new Promise(function(o,i){var s=0,c=setTimeout(function(){0===s&&(s=2,c=null,i("请求超时"),0==n&&r())},5e3);fetch(e).then(function(e){if(2!==s&&(clearTimeout(c),o(e),c=null,s=1),e.ok)return e.json();throw new Error("Network response was not ok.")}).then(function(e){n=0,t(e)})["catch"](function(e){n>0?(n-=1,setTimeout(function(){a()},5e3)):r()})})}()},layout:function(e){var t=e.el;FriendsJS.requestAPI(e.api,function(r){t.querySelector(".loading-wrap").remove();var n=r.content,a="";n.forEach(function(t,r){var n='<div class="user-card">';n+='<a class="card-link" target="_blank" rel="external noopener noreferrer"',n+=' href="'+t.url+'">',n+='<img alt="'+t.title+'" src="'+(t.avatar||e.avatar)+'" onerror="errorImgAvatar(this)">',n+='<div class="name"><span>'+t.title+"</span></div>",n+="</a>",a+=n+="</div>"}),t.querySelector(".group-body").innerHTML=a},function(){try{t.querySelector(".loading-wrap svg").remove(),t.querySelector(".loading-wrap p").innerText("加载失败，请稍后重试。")}catch(e){}})},start:function(){for(var e=document.getElementsByClassName("friendsjs-wrap"),t=0;t<e.length;t++){var r=e[t],n=r.getAttribute("api");if(null!=n){var a=new Object;a.el=r,a.api=n,a["class"]=r.getAttribute("class"),a.avatar=volantis.GLOBAL_CONFIG["default"].avatar,FriendsJS.layout(a)}}}};FriendsJS.start(),document.addEventListener("pjax:complete",function(){FriendsJS.start()});
//# sourceMappingURL=../../../maps/js/plugins/tags/friends.js.map
