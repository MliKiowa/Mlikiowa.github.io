"use strict";var SitesJS={requestAPI:function(t,e,r){var n=5;!function a(){return new Promise(function(o,i){var s=0,c=setTimeout(function(){0===s&&(s=2,c=null,i("请求超时"),0==n&&r())},5e3);fetch(t).then(function(t){if(2!==s&&(clearTimeout(c),o(t),c=null,s=1),t.ok)return t.json();throw new Error("Network response was not ok.")}).then(function(t){n=0,e(t)})["catch"](function(t){n>0?(n-=1,setTimeout(function(){a()},5e3)):r()})})}()},layout:function(t){var e=t.el;SitesJS.requestAPI(t.api,function(r){e.querySelector(".loading-wrap").remove();var n=r.content,a="";n.forEach(function(e,r){var n='<div class="site-card">';n+='<a class="card-link" target="_blank" rel="external noopener noreferrer" href="'+e.url+'">',n+='<img alt="'+e.title+'" src="'+(e.screenshot||"https://image.thum.io/get/width/1024/crop/768/"+e.url)+'" onerror="errorImgCover(this)"/>',n+='<div class="info">',n+='<img alt="'+e.title+'" src="'+(e.avatar||t.avatar)+'" onerror="errorImgAvatar(this)"/>',n+='<span class="title">'+e.title+"</span>",n+='<span class="desc">'+(e.description||e.url)+"</span>",n+="</div>",n+="</a>",a+=n+="</div>"}),e.querySelector(".group-body").innerHTML=a},function(){try{e.querySelector(".loading-wrap svg").remove(),e.querySelector(".loading-wrap p").innerText("加载失败，请稍后重试。")}catch(t){}})},start:function(t){for(var e=document.getElementsByClassName("sitesjs-wrap"),r=0;r<e.length;r++){var n=e[r],a=n.getAttribute("api");if(null!=a)(t=new Object)["class"]=n.getAttribute("class"),t.el=n,t.api=a,t.avatar=volantis.GLOBAL_CONFIG["default"].link,t.screenshot=volantis.GLOBAL_CONFIG["default"].cover,SitesJS.layout(t)}}};SitesJS.start(),document.addEventListener("pjax:complete",function(){SitesJS.start()});
//# sourceMappingURL=../../../maps/js/plugins/tags/sites.js.map
